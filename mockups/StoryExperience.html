<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ä½“é¨“ãƒšãƒ¼ã‚¸ - ãƒ¢ãƒƒã‚¯ã‚¢ãƒƒãƒ—</title>

  <!-- Material UI Fonts -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap"/>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap"/>
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"/>

  <style>
    /*
      ğŸ“Œ MUIå¤‰æ›ãƒãƒƒãƒ”ãƒ³ã‚°è¡¨
      ã“ã®HTMLãƒ¢ãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¯ä»¥ä¸‹ã®MUIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«å¤‰æ›ã•ã‚Œã¾ã™:

      å…¨ä½“æ§‹é€ :
      - body â†’ PublicLayoutï¼ˆãƒ˜ãƒƒãƒ€ãƒ¼ãƒ»èƒŒæ™¯ã¯LayoutãŒæä¾›ï¼‰
      - main container â†’ Container maxWidth="lg"

      ãƒ†ã‚­ã‚¹ãƒˆ:
      - h1 â†’ Typography variant="h4" component="h1"
      - h2 â†’ Typography variant="h5" component="h2"
      - h3 â†’ Typography variant="h6" component="h3"
      - p â†’ Typography variant="body1"
      - small â†’ Typography variant="body2"

      ãƒœã‚¿ãƒ³:
      - .level-filter-btn â†’ Button variant="outlined"
      - .audio-button â†’ Button variant="contained" color="primary"
      - .back-button â†’ Button variant="outlined"
      - .toggle-button â†’ Button variant="outlined" size="small"
      - .quick-action-btn â†’ Button variant="contained" color="warning"

      ã‚«ãƒ¼ãƒ‰:
      - .story-card â†’ Card + CardContent
      - .choice-card â†’ Card + CardContent

      å…¥åŠ›:
      - progress bar â†’ LinearProgress variant="determinate"

      ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ:
      - margin/padding â†’ spacing()åŸºæº–ï¼ˆ8pxå˜ä½ï¼‰
      - Box component for layout containers

      è‰²ï¼ˆã‚¢ãƒ¼ã‚¹ã‚«ãƒ©ãƒ¼åŸºèª¿ï¼‰:
      - theme.palette.primary.main: #7A9C5E (è½ã¡ç€ã„ãŸã‚»ãƒ¼ã‚¸ã‚°ãƒªãƒ¼ãƒ³)
      - theme.palette.secondary.main: #A67C52 (ãƒŠãƒãƒ¥ãƒ©ãƒ«ãƒ–ãƒ©ã‚¦ãƒ³)
      - theme.palette.warning.main: #C9A573 (ã‚½ãƒ•ãƒˆã‚´ãƒ¼ãƒ«ãƒ‰)
      - theme.palette.background.default: #F4EDE4 (ãƒŠãƒãƒ¥ãƒ©ãƒ«ãƒ™ãƒ¼ã‚¸ãƒ¥)
      - theme.palette.background.paper: #FAF7F2 (ã‚¦ã‚©ãƒ¼ãƒ ãƒ›ãƒ¯ã‚¤ãƒˆ)
      - theme.palette.text.primary: #3E4A3C (ãƒ‡ã‚£ãƒ¼ãƒ—ã‚°ãƒªãƒ¼ãƒ³)
      - theme.palette.text.secondary: #6B7A64 (ãƒŸãƒ‡ã‚£ã‚¢ãƒ ã‚°ãƒªãƒ¼ãƒ³)
    */

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Noto Sans JP', 'Roboto', sans-serif;
      font-size: 14px;
      color: #3E4A3C; /* theme.palette.text.primary */
      background: #F4EDE4; /* theme.palette.background.default */
      line-height: 1.5;
    }

    /* Main Container - MUI: Container maxWidth="lg" */
    .story-experience-container {
      max-width: 1280px; /* lg breakpoint */
      margin: 0 auto;
      padding: 16px; /* spacing(2) */
    }

    /* Level Selection Section - MUI: Box mb={4} */
    .level-selection {
      margin-bottom: 32px; /* spacing(4) */
      padding: 24px; /* spacing(3) */
      background: #7A9C5E; /* theme.palette.primary.main */
      border-radius: 8px; /* theme.shape.borderRadius */
      box-shadow: 0px 2px 4px rgba(0,0,0,0.08);
    }

    /* MUI: Typography variant="h4" component="h1" color="white" */
    .level-selection h1 {
      font-size: 2.125rem;
      font-weight: 500;
      line-height: 1.235;
      margin-bottom: 16px; /* spacing(2) */
      color: #FFFFFF; /* theme.palette.primary.contrastText */
    }

    /* MUI: Box display="flex" gap={1} flexWrap="wrap" */
    .level-filters {
      display: flex;
      gap: 8px; /* spacing(1) */
      flex-wrap: wrap;
    }

    /* MUI: Button variant="outlined" color="inherit" size="medium" */
    .level-filter-btn {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.5);
      color: #FFFFFF;
      padding: 6px 16px;
      border-radius: 4px;
      cursor: pointer;
      font-family: 'Noto Sans JP', 'Roboto', sans-serif;
      font-weight: 500;
      font-size: 0.875rem;
      text-transform: none;
      transition: all 250ms cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: none;
    }

    .level-filter-btn:hover {
      background: rgba(255, 255, 255, 0.2);
      border-color: rgba(255, 255, 255, 0.7);
    }

    /* MUI: active state with color="warning" */
    .level-filter-btn.active {
      background: #C9A573; /* theme.palette.warning.main */
      border-color: #C9A573;
      color: #FFFFFF; /* theme.palette.warning.contrastText */
    }

    /* Story List Section - MUI: Box mb={4} */
    .story-list {
      margin-bottom: 32px; /* spacing(4) */
    }

    /* MUI: Typography variant="h5" component="h2" mb={3} */
    .story-list h2 {
      font-size: 1.5rem;
      font-weight: 500;
      line-height: 1.334;
      margin-bottom: 24px; /* spacing(3) */
      color: #3E4A3C; /* theme.palette.text.primary */
    }

    /* MUI: Grid container spacing={3} */
    .story-cards {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 24px; /* spacing(3) */
    }

    /* MUI: Card + CardContent */
    .story-card {
      background: #FAF7F2; /* theme.palette.background.paper */
      border: 1px solid rgba(122, 156, 94, 0.12); /* theme.palette.divider */
      border-radius: 8px; /* theme.shape.borderRadius */
      padding: 16px; /* spacing(2) */
      cursor: pointer;
      transition: all 300ms cubic-bezier(0.4, 0, 0.2, 1); /* theme.transitions.duration.standard */
      box-shadow: 0px 2px 4px rgba(0,0,0,0.06);
    }

    .story-card:hover {
      border-color: #7A9C5E; /* theme.palette.primary.main */
      transform: translateY(-4px);
      box-shadow: 0px 4px 8px rgba(122, 156, 94, 0.15);
    }

    /* MUI: Chip color="primary" size="small" */
    .story-card-badge {
      display: inline-block;
      background: #7A9C5E; /* theme.palette.primary.main */
      color: #FFFFFF; /* theme.palette.primary.contrastText */
      padding: 4px 12px;
      border-radius: 16px;
      font-size: 0.8125rem;
      font-weight: 500;
      margin-bottom: 8px; /* spacing(1) */
    }

    /* MUI: Typography variant="h6" component="h3" mb={1} */
    .story-card-title {
      font-size: 1.25rem;
      font-weight: 500;
      line-height: 1.6;
      margin-bottom: 8px; /* spacing(1) */
      color: #3E4A3C; /* theme.palette.text.primary */
    }

    /* MUI: Typography variant="body2" color="text.secondary" mb={2} */
    .story-card-desc {
      font-size: 0.875rem;
      line-height: 1.43;
      margin-bottom: 16px; /* spacing(2) */
      color: #6B7A64; /* theme.palette.text.secondary */
    }

    /* MUI: Box display="flex" justifyContent="space-between" mt={2} pt={2} */
    .story-card-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.875rem;
      margin-top: 16px; /* spacing(2) */
      padding-top: 16px; /* spacing(2) */
      border-top: 1px solid rgba(122, 156, 94, 0.12); /* theme.palette.divider */
    }

    /* MUI: Typography variant="body2" color="primary" fontWeight="medium" */
    .story-progress {
      font-weight: 500;
      color: #7A9C5E; /* theme.palette.primary.main */
    }

    /* Story Viewer Section - MUI: Box display={visible ? 'block' : 'none'} */
    .story-viewer {
      display: none;
      transition: opacity 400ms cubic-bezier(0.4, 0, 0.2, 1), transform 400ms cubic-bezier(0.4, 0, 0.2, 1);
    }

    .story-viewer.active {
      display: block;
      animation: fadeIn 300ms cubic-bezier(0.4, 0, 0.2, 1); /* theme.transitions.duration.standard */
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(16px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* MUI: Box mb={4} */
    .story-header {
      margin-bottom: 32px; /* spacing(4) */
    }

    /* MUI: Button variant="outlined" startIcon={<ArrowBackIcon />} mb={2} */
    .back-button {
      background: transparent;
      border: 1px solid rgba(122, 156, 94, 0.5);
      color: #7A9C5E; /* theme.palette.primary.main */
      padding: 6px 16px;
      border-radius: 4px;
      cursor: pointer;
      font-family: 'Noto Sans JP', 'Roboto', sans-serif;
      font-weight: 500;
      font-size: 0.875rem;
      margin-bottom: 16px; /* spacing(2) */
      display: inline-flex;
      align-items: center;
      gap: 8px; /* spacing(1) */
      transition: all 250ms cubic-bezier(0.4, 0, 0.2, 1);
    }

    .back-button:hover {
      background: rgba(122, 156, 94, 0.08); /* theme.palette.action.hover */
      border-color: #7A9C5E;
    }

    /* MUI: Chip color="primary" mb={2} */
    .story-level-badge {
      display: inline-flex;
      align-items: center;
      gap: 8px; /* spacing(1) */
      background: #7A9C5E; /* theme.palette.primary.main */
      color: #FFFFFF; /* theme.palette.primary.contrastText */
      padding: 8px 16px; /* spacing(1) spacing(2) */
      border-radius: 16px;
      font-weight: 500;
      margin-bottom: 16px; /* spacing(2) */
      font-size: 0.875rem;
    }

    /* MUI: Typography variant="h4" component="h1" mb={3} */
    .story-title {
      font-size: 2.125rem;
      font-weight: 500;
      line-height: 1.235;
      margin-bottom: 24px; /* spacing(3) */
      color: #3E4A3C; /* theme.palette.text.primary */
    }

    /* Progress Container - MUI: Box my={3} */
    .progress-container {
      margin: 24px 0; /* spacing(3) */
    }

    /* MUI: Box display="flex" justifyContent="space-between" mb={1} */
    .progress-label {
      display: flex;
      justify-content: space-between;
      font-size: 0.875rem;
      color: #6B7A64; /* theme.palette.text.secondary */
      margin-bottom: 8px; /* spacing(1) */
      font-weight: 500;
    }

    /* MUI: LinearProgress variant="determinate" value={20} sx={{ height: 8, borderRadius: 4 }} */
    .progress-bar {
      background: rgba(122, 156, 94, 0.12);
      height: 8px;
      border-radius: 4px;
      overflow: hidden;
    }

    .progress-fill {
      background: #7A9C5E; /* theme.palette.primary.main */
      height: 100%;
      transition: width 500ms cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* Content Box - MUI: Paper elevation={1} p={4} my={3} */
    .content-box {
      background: #FAF7F2; /* theme.palette.background.paper */
      padding: 32px; /* spacing(4) */
      border-radius: 8px; /* theme.shape.borderRadius */
      margin: 24px 0; /* spacing(3) */
      line-height: 2;
      font-size: 1rem;
      color: #3E4A3C; /* theme.palette.text.primary */
      box-shadow: 0px 2px 4px rgba(0,0,0,0.06);
    }

    /* MUI: Box display="flex" gap={2} mb={2} */
    .content-options {
      display: flex;
      gap: 16px; /* spacing(2) */
      margin-bottom: 16px; /* spacing(2) */
    }

    /* MUI: Button variant="outlined" size="small" */
    .toggle-button {
      background: transparent;
      border: 1px solid rgba(122, 156, 94, 0.5);
      color: #7A9C5E; /* theme.palette.primary.main */
      padding: 4px 10px;
      border-radius: 4px;
      cursor: pointer;
      font-family: 'Noto Sans JP', 'Roboto', sans-serif;
      font-weight: 500;
      font-size: 0.8125rem;
      transition: all 250ms cubic-bezier(0.4, 0, 0.2, 1);
    }

    .toggle-button:hover {
      background: rgba(122, 156, 94, 0.08); /* theme.palette.action.hover */
    }

    /* MUI: active state (Button variant="contained" color="primary") */
    .toggle-button.active {
      background: #7A9C5E; /* theme.palette.primary.main */
      color: #FFFFFF; /* theme.palette.primary.contrastText */
      border-color: #7A9C5E;
    }

    /* Ruby visibility control */
    .content-text.hide-ruby ruby rt {
      display: none;
    }

    /* MUI: Box display={show ? 'block' : 'none'} mt={2} pt={2} */
    .content-translation {
      display: none;
      margin-top: 16px; /* spacing(2) */
      padding-top: 16px; /* spacing(2) */
      border-top: 1px dashed rgba(122, 156, 94, 0.12); /* theme.palette.divider */
      color: #6B7A64; /* theme.palette.text.secondary */
      font-style: italic;
      line-height: 1.8;
    }

    .content-translation.show {
      display: block;
    }

    /* Audio Control - MUI: Box my={3} */
    .audio-control {
      margin: 24px 0; /* spacing(3) */
    }

    /* MUI: Button variant="contained" color="primary" startIcon={<VolumeUpIcon />} */
    .audio-button {
      background: #7A9C5E; /* theme.palette.primary.main */
      color: #FFFFFF; /* theme.palette.primary.contrastText */
      border: none;
      padding: 8px 22px;
      border-radius: 4px;
      font-family: 'Noto Sans JP', 'Roboto', sans-serif;
      font-size: 0.875rem;
      font-weight: 500;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 8px; /* spacing(1) */
      transition: all 250ms cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0px 3px 1px -2px rgba(0,0,0,0.15), 0px 2px 2px 0px rgba(0,0,0,0.1), 0px 1px 5px 0px rgba(0,0,0,0.08);
    }

    .audio-button:hover {
      background: #6A8A50; /* theme.palette.primary.dark */
      box-shadow: 0px 2px 4px -1px rgba(0,0,0,0.15), 0px 4px 5px 0px rgba(0,0,0,0.1), 0px 1px 10px 0px rgba(0,0,0,0.08);
    }

    .audio-button:active {
      box-shadow: 0px 5px 5px -3px rgba(0,0,0,0.15), 0px 8px 10px 1px rgba(0,0,0,0.1), 0px 3px 14px 2px rgba(0,0,0,0.08);
    }

    .audio-button.playing {
      background: #A67C52; /* theme.palette.secondary.main */
      animation: pulse 1.5s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.85; }
    }

    /* Choices Section - MUI: Box mt={5} */
    .choices-section {
      margin-top: 40px; /* spacing(5) */
    }

    /* MUI: Typography variant="h6" component="h3" mb={3} */
    .choices-section h3 {
      font-size: 1.25rem;
      font-weight: 500;
      line-height: 1.6;
      margin-bottom: 24px; /* spacing(3) */
      color: #3E4A3C; /* theme.palette.text.primary */
    }

    /* MUI: Grid container spacing={3} */
    .choices-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 24px; /* spacing(3) */
    }

    /* MUI: Card + CardContent (clickable) */
    .choice-card {
      background: #FAF7F2; /* theme.palette.background.paper */
      border: 2px solid rgba(122, 156, 94, 0.12); /* theme.palette.divider */
      border-radius: 8px; /* theme.shape.borderRadius */
      padding: 24px; /* spacing(3) */
      cursor: pointer;
      transition: all 300ms cubic-bezier(0.4, 0, 0.2, 1); /* theme.transitions.duration.standard */
      box-shadow: 0px 2px 4px rgba(0,0,0,0.06);
    }

    .choice-card:hover {
      border-color: #7A9C5E; /* theme.palette.primary.main */
      transform: translateY(-4px);
      box-shadow: 0px 4px 8px rgba(122, 156, 94, 0.2);
      background: rgba(122, 156, 94, 0.04);
    }

    /* MUI: selected state */
    .choice-card.selected {
      border-color: #C9A573; /* theme.palette.warning.main */
      background: rgba(201, 165, 115, 0.12); /* theme.palette.warning.main with opacity */
      box-shadow: 0px 4px 8px rgba(201, 165, 115, 0.3);
    }

    /* Fade out animation for chapter transition */
    .choice-card.fade-out {
      opacity: 0;
      transform: translateY(-20px);
    }

    /* MUI: Avatar sx={{ bgcolor: 'primary.main' }} */
    .choice-number {
      background: #7A9C5E; /* theme.palette.primary.main */
      color: #FFFFFF; /* theme.palette.primary.contrastText */
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 500;
      margin-bottom: 16px; /* spacing(2) */
      font-size: 1rem;
    }

    /* MUI: Typography variant="subtitle1" fontWeight="medium" mb={1} */
    .choice-text {
      font-size: 1rem;
      font-weight: 500;
      line-height: 1.75;
      margin-bottom: 8px; /* spacing(1) */
      color: #3E4A3C; /* theme.palette.text.primary */
    }

    /* MUI: Typography variant="body2" color="text.secondary" */
    .choice-desc {
      font-size: 0.875rem;
      line-height: 1.43;
      color: #6B7A64; /* theme.palette.text.secondary */
    }

    /* Quick Actions - MUI: Box mt={4} pt={4} */
    .quick-actions {
      margin-top: 32px; /* spacing(4) */
      padding-top: 32px; /* spacing(4) */
      border-top: 1px solid rgba(122, 156, 94, 0.12); /* theme.palette.divider */
      display: flex;
      gap: 16px; /* spacing(2) */
      flex-wrap: wrap;
    }

    /* MUI: Button variant="contained" color="warning" startIcon={<CheckIcon />} */
    .quick-action-btn {
      background: #C9A573; /* theme.palette.warning.main */
      color: #FFFFFF; /* theme.palette.warning.contrastText */
      border: none;
      padding: 8px 22px;
      border-radius: 4px;
      font-family: 'Noto Sans JP', 'Roboto', sans-serif;
      font-weight: 500;
      font-size: 0.875rem;
      cursor: pointer;
      transition: all 250ms cubic-bezier(0.4, 0, 0.2, 1);
      display: inline-flex;
      align-items: center;
      gap: 8px; /* spacing(1) */
      box-shadow: 0px 3px 1px -2px rgba(0,0,0,0.15), 0px 2px 2px 0px rgba(0,0,0,0.1), 0px 1px 5px 0px rgba(0,0,0,0.08);
    }

    .quick-action-btn:hover {
      background: #B89563; /* theme.palette.warning.dark */
      box-shadow: 0px 2px 4px -1px rgba(0,0,0,0.15), 0px 4px 5px 0px rgba(0,0,0,0.1), 0px 1px 10px 0px rgba(0,0,0,0.08);
    }

    .quick-action-btn:active {
      transform: scale(0.98);
    }

    /* Loading Indicator - MUI: Box display={loading ? 'flex' : 'none'} */
    .loading {
      display: none;
      text-align: center;
      padding: 32px; /* spacing(4) */
    }

    .loading.show {
      display: block;
    }

    /* MUI: CircularProgress */
    .spinner {
      border: 4px solid rgba(122, 156, 94, 0.12);
      border-top: 4px solid #7A9C5E; /* theme.palette.primary.main */
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 0 auto 16px; /* spacing(2) */
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Responsive Design */
    @media (max-width: 960px) { /* md breakpoint */
      .story-experience-container {
        padding: 8px; /* spacing(1) */
      }

      .level-selection,
      .content-box {
        padding: 16px; /* spacing(2) */
      }

      .story-title {
        font-size: 1.75rem;
      }

      .choices-container,
      .story-cards {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <!--
    ğŸ“Œ ãƒšãƒ¼ã‚¸ã‚¿ã‚¤ãƒ—: å…¬é–‹ãƒšãƒ¼ã‚¸ï¼ˆèªè¨¼ä¸è¦ï¼‰
    ğŸ“Œ ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ: PublicLayoutä½¿ç”¨ï¼ˆReactå®Ÿè£…æ™‚ï¼‰
    ğŸ“Œ ã“ã®ãƒ¢ãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¯ã‚³ãƒ³ãƒ†ãƒ³ãƒ„éƒ¨åˆ†ã®ã¿ã‚’å«ã‚€
    ğŸ“Œ ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ»èƒŒæ™¯ã¯PublicLayoutãŒæä¾›
  -->

  <!-- MUI: Container maxWidth="lg" -->
  <div class="story-experience-container">

    <!-- Story List Section - MUI: Box -->
    <div id="story-list-section">

      <!-- Level Selection - MUI: Box mb={4} p={3} bgcolor="primary.main" borderRadius={1} -->
      <div class="level-selection">
        <!-- MUI: Typography variant="h4" component="h1" color="white" mb={2} -->
        <h1>ãƒ¬ãƒ™ãƒ«åˆ¥ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ä¸€è¦§</h1>

        <!-- MUI: Box display="flex" gap={1} flexWrap="wrap" -->
        <div class="level-filters">
          <!-- MUI: Button variant="outlined" color="inherit" -->
          <button class="level-filter-btn active" data-level="all">ã™ã¹ã¦</button>
          <button class="level-filter-btn" data-level="N5-A1">N5 / A1</button>
          <button class="level-filter-btn" data-level="N4-A2">N4 / A2</button>
          <button class="level-filter-btn" data-level="N3-B1">N3 / B1</button>
          <button class="level-filter-btn" data-level="N2-B2">N2 / B2</button>
          <button class="level-filter-btn" data-level="N1-C1">N1 / C1-C2</button>
        </div>
      </div>

      <!-- Story List - MUI: Box mb={4} -->
      <div class="story-list">
        <!-- MUI: Typography variant="h5" component="h2" mb={3} -->
        <h2>ãŠã™ã™ã‚ã®ã‚¹ãƒˆãƒ¼ãƒªãƒ¼</h2>

        <!-- MUI: Grid container spacing={3} -->
        <div class="story-cards">

          <!-- Story Card 1 - MUI: Card -->
          <div class="story-card" data-level="N3-B1" data-story-id="1">
            <!-- MUI: Chip color="primary" size="small" label="N3 / B1" -->
            <div class="story-card-badge">N3 / B1</div>

            <!-- MUI: Typography variant="h6" component="h3" mb={1} -->
            <div class="story-card-title">æ±äº¬ã§ã®æ–°ã—ã„ç”Ÿæ´»</div>

            <!-- MUI: Typography variant="body2" color="text.secondary" mb={2} -->
            <div class="story-card-desc">åˆã‚ã¦æ±äº¬ã«æ¥ãŸç•™å­¦ç”Ÿã®1æ—¥ã‚’è¿½ä½“é¨“ã€‚æ¸‹è°·ã§ã®é¸æŠãŒã‚ãªãŸã®ç‰©èªã‚’å¤‰ãˆã¾ã™ã€‚</div>

            <!-- MUI: Box display="flex" justifyContent="space-between" mt={2} pt={2} borderTop={1} -->
            <div class="story-card-meta">
              <!-- MUI: Typography variant="body2" -->
              <span>ç´„10åˆ†</span>
              <!-- MUI: Typography variant="body2" color="primary" fontWeight="medium" -->
              <span class="story-progress">é€²æ—: 0%</span>
            </div>
          </div>

          <!-- Story Card 2 - MUI: Card -->
          <div class="story-card" data-level="N4-A2" data-story-id="2">
            <div class="story-card-badge">N4 / A2</div>
            <div class="story-card-title">ã‚«ãƒ•ã‚§ã§ã®å‡ºä¼šã„</div>
            <div class="story-card-desc">å¶ç„¶å…¥ã£ãŸã‚«ãƒ•ã‚§ã§å§‹ã¾ã‚‹ã€å¿ƒæ¸©ã¾ã‚‹å‹æƒ…ã®ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã€‚</div>
            <div class="story-card-meta">
              <span>ç´„8åˆ†</span>
              <span class="story-progress">é€²æ—: 0%</span>
            </div>
          </div>

          <!-- Story Card 3 - MUI: Card -->
          <div class="story-card" data-level="N5-A1" data-story-id="3">
            <div class="story-card-badge">N5 / A1</div>
            <div class="story-card-title">åˆã‚ã¦ã®ã‚³ãƒ³ãƒ“ãƒ‹</div>
            <div class="story-card-desc">æ—¥æœ¬ã®ã‚³ãƒ³ãƒ“ãƒ‹ã§ã®è²·ã„ç‰©ã€‚ç°¡å˜ãªæ—¥å¸¸ä¼šè©±ã‹ã‚‰å­¦ã³ã¾ã—ã‚‡ã†ã€‚</div>
            <div class="story-card-meta">
              <span>ç´„5åˆ†</span>
              <span class="story-progress">é€²æ—: 0%</span>
            </div>
          </div>

          <!-- Story Card 4 - MUI: Card -->
          <div class="story-card" data-level="N2-B2" data-story-id="4">
            <div class="story-card-badge">N2 / B2</div>
            <div class="story-card-title">å°±è·æ´»å‹•ã®æŒ‘æˆ¦</div>
            <div class="story-card-desc">æ—¥æœ¬ã§ã®å°±è·æ´»å‹•ã€‚é¢æ¥ã‚„ãƒ“ã‚¸ãƒã‚¹ãƒãƒŠãƒ¼ã‚’å­¦ã¶ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã€‚</div>
            <div class="story-card-meta">
              <span>ç´„15åˆ†</span>
              <span class="story-progress">é€²æ—: 0%</span>
            </div>
          </div>

          <!-- Story Card 5 - MUI: Card -->
          <div class="story-card" data-level="N1-C1" data-story-id="5">
            <div class="story-card-badge">N1 / C1</div>
            <div class="story-card-title">äº¬éƒ½ã®ä¼çµ±æ–‡åŒ–</div>
            <div class="story-card-desc">äº¬éƒ½ã®ä¼çµ±å·¥èŠ¸è·äººã¨ã®å¯¾è©±ã€‚æ·±ã„æ–‡åŒ–ç†è§£ã‚’ç›®æŒ‡ã—ã¾ã™ã€‚</div>
            <div class="story-card-meta">
              <span>ç´„20åˆ†</span>
              <span class="story-progress">é€²æ—: 0%</span>
            </div>
          </div>

          <!-- Story Card 6 - MUI: Card -->
          <div class="story-card" data-level="N3-B1" data-story-id="6">
            <div class="story-card-badge">N3 / B1</div>
            <div class="story-card-title">é€±æœ«ã®æ—…è¡Œè¨ˆç”»</div>
            <div class="story-card-desc">å‹é”ã¨é€±æœ«æ—…è¡Œã‚’è¨ˆç”»ã€‚è¡Œãå…ˆã¯ã‚ãªãŸãŒæ±ºã‚ã¾ã™ã€‚</div>
            <div class="story-card-meta">
              <span>ç´„12åˆ†</span>
              <span class="story-progress">é€²æ—: 0%</span>
            </div>
          </div>

        </div>
      </div>
    </div>

    <!-- Story Viewer Section - MUI: Box display={visible ? 'block' : 'none'} -->
    <div id="story-viewer" class="story-viewer">

      <!-- Story Header - MUI: Box mb={4} -->
      <div class="story-header">
        <!-- MUI: Button variant="outlined" startIcon={<ArrowBackIcon />} mb={2} -->
        <button class="back-button" id="back-to-list">
          <span>â†</span>
          <span>ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ä¸€è¦§ã«æˆ»ã‚‹</span>
        </button>

        <!-- MUI: Chip color="primary" icon={<BookIcon />} label="N3 / B1" mb={2} -->
        <div class="story-level-badge">
          <span>ğŸ“š N3 / B1</span>
        </div>

        <!-- MUI: Typography variant="h4" component="h1" mb={3} -->
        <h1 class="story-title">æ±äº¬ã§ã®æ–°ã—ã„ç”Ÿæ´»</h1>

        <!-- Progress Container - MUI: Box my={3} -->
        <div class="progress-container">
          <!-- MUI: Box display="flex" justifyContent="space-between" mb={1} -->
          <div class="progress-label">
            <!-- MUI: Typography variant="body2" color="text.secondary" -->
            <span>ãƒãƒ£ãƒ—ã‚¿ãƒ¼ 1/5</span>
            <span id="progress-percent">20%</span>
          </div>

          <!-- MUI: LinearProgress variant="determinate" value={20} sx={{ height: 8, borderRadius: 4 }} -->
          <div class="progress-bar">
            <div class="progress-fill" id="progress-fill" style="width: 20%;"></div>
          </div>
        </div>
      </div>

      <!-- Content Options - MUI: Box display="flex" gap={2} mb={2} -->
      <div class="content-options">
        <!-- MUI: Button variant="outlined" size="small" color="primary" -->
        <button class="toggle-button active" id="toggle-ruby">ãƒ«ãƒ“è¡¨ç¤º</button>
        <button class="toggle-button" id="toggle-translation">ç¿»è¨³è¡¨ç¤º</button>
      </div>

      <!-- Content Box - MUI: Paper elevation={1} p={4} my={3} -->
      <div class="content-box">
        <!-- MUI: Typography variant="body1" component="div" -->
        <div class="content-text" id="story-content">
          <ruby>ä»Šæ—¥<rt>ãã‚‡ã†</rt></ruby>ã¯<ruby>ç§<rt>ã‚ãŸã—</rt></ruby>ã®<ruby>æ±äº¬<rt>ã¨ã†ãã‚‡ã†</rt></ruby>ã§ã®<ruby>æ–°<rt>ã‚ãŸã‚‰</rt></ruby>ã—ã„<ruby>ç”Ÿæ´»<rt>ã›ã„ã‹ã¤</rt></ruby>ã®<ruby>åˆ<rt>ã¯ã˜</rt></ruby>ã‚ã¦ã®<ruby>æ—¥<rt>ã²</rt></ruby>ã§ã™ã€‚<ruby>æ¸‹è°·<rt>ã—ã¶ã‚„</rt></ruby>ã®<ruby>é§…<rt>ãˆã</rt></ruby>ã«<ruby>ç€<rt>ã¤</rt></ruby>ã„ã¦ã€<ruby>äºº<rt>ã²ã¨</rt></ruby>ã®<ruby>å¤š<rt>ãŠãŠ</rt></ruby>ã•ã«<ruby>é©š<rt>ãŠã©ã‚</rt></ruby>ãã¾ã—ãŸã€‚ã“ã‚Œã‹ã‚‰ã€ã©ã“ã¸<ruby>è¡Œ<rt>ã„</rt></ruby>ãã¾ã—ã‚‡ã†ã‹ï¼Ÿ
        </div>

        <!-- MUI: Box display={show ? 'block' : 'none'} mt={2} pt={2} borderTop="1px dashed" -->
        <div class="content-translation" id="translation">
          Today is my first day of a new life in Tokyo. I arrived at Shibuya Station and was surprised by the number of people. Where should I go from here?
        </div>
      </div>

      <!-- Audio Control - MUI: Box my={3} -->
      <div class="audio-control">
        <!-- MUI: Button variant="contained" color="primary" startIcon={<VolumeUpIcon />} -->
        <button class="audio-button" id="audio-button">
          <span id="audio-icon">ğŸ”Š</span>
          <span id="audio-text">éŸ³å£°ã‚’èã</span>
        </button>
      </div>

      <!-- Choices Section - MUI: Box mt={5} -->
      <div class="choices-section">
        <!-- MUI: Typography variant="h6" component="h3" mb={3} -->
        <h3>æ¬¡ã¯ã©ã†ã—ã¾ã™ã‹ï¼Ÿ</h3>

        <!-- MUI: Grid container spacing={3} -->
        <div class="choices-container">

          <!-- Choice Card 1 - MUI: Card (clickable) -->
          <div class="choice-card" data-choice-id="1">
            <!-- MUI: Avatar sx={{ bgcolor: 'primary.main' }} -->
            <div class="choice-number">1</div>

            <!-- MUI: Typography variant="subtitle1" fontWeight="medium" mb={1} -->
            <div class="choice-text">ã‚«ãƒ•ã‚§ã§ä¼‘æ†©ã™ã‚‹</div>

            <!-- MUI: Typography variant="body2" color="text.secondary" -->
            <div class="choice-desc">ç–²ã‚ŒãŸã®ã§ã€è¿‘ãã®ã‚«ãƒ•ã‚§ã§ä¸€ä¼‘ã¿ã—ã¦ã€ã‚†ã£ãã‚Šè€ƒãˆã¾ã—ã‚‡ã†ã€‚</div>
          </div>

          <!-- Choice Card 2 - MUI: Card (clickable) -->
          <div class="choice-card" data-choice-id="2">
            <div class="choice-number">2</div>
            <div class="choice-text">è¦³å…‰ã‚¹ãƒãƒƒãƒˆã‚’æ¢ã™</div>
            <div class="choice-desc">ã›ã£ã‹ãæ¸‹è°·ã«æ¥ãŸã®ã§ã€æœ‰åãªè¦³å…‰åœ°ã‚’è¨ªã‚Œã¦ã¿ãŸã„ã§ã™ã€‚</div>
          </div>

          <!-- Choice Card 3 - MUI: Card (clickable) -->
          <div class="choice-card" data-choice-id="3">
            <div class="choice-number">3</div>
            <div class="choice-text">ã‚¢ãƒ‘ãƒ¼ãƒˆã¸ç›´è¡Œã™ã‚‹</div>
            <div class="choice-desc">è·ç‰©ãŒé‡ã„ã®ã§ã€ã¾ãšæ–°ã—ã„ã‚¢ãƒ‘ãƒ¼ãƒˆã«å‘ã‹ã£ã¦è·ç‰©ã‚’ç½®ããŸã„ã§ã™ã€‚</div>
          </div>

        </div>
      </div>

      <!-- Quick Actions - MUI: Box mt={4} pt={4} borderTop={1} -->
      <div class="quick-actions">
        <!-- MUI: Button variant="contained" color="warning" startIcon={<CheckIcon />} -->
        <button class="quick-action-btn" id="goto-quiz">
          <span>âœ“</span>
          <span>ç†è§£åº¦ãƒã‚§ãƒƒã‚¯ã¸</span>
        </button>
      </div>

    </div>

    <!-- Loading Indicator - MUI: Box display={loading ? 'flex' : 'none'} textAlign="center" p={4} -->
    <div class="loading" id="loading">
      <!-- MUI: CircularProgress -->
      <div class="spinner"></div>
      <!-- MUI: Typography variant="body1" -->
      <p>èª­ã¿è¾¼ã¿ä¸­...</p>
    </div>

  </div>

  <script>
    // State Management (Reactå®Ÿè£…æ™‚ã¯Zustand + useReducerã«å¤‰æ›)
    const appState = {
      currentStoryId: null,
      currentChapterId: 1,
      selectedChoiceId: null,
      progress: 20,
      showRuby: true,
      showTranslation: false,
      completedChapters: []
    };

    // DOM Elements
    const storyListSection = document.getElementById('story-list-section');
    const storyViewer = document.getElementById('story-viewer');
    const loading = document.getElementById('loading');
    const backButton = document.getElementById('back-to-list');
    const toggleRubyBtn = document.getElementById('toggle-ruby');
    const toggleTranslationBtn = document.getElementById('toggle-translation');
    const storyContent = document.getElementById('story-content');
    const translation = document.getElementById('translation');
    const audioButton = document.getElementById('audio-button');
    const audioIcon = document.getElementById('audio-icon');
    const audioText = document.getElementById('audio-text');
    const progressFill = document.getElementById('progress-fill');
    const progressPercent = document.getElementById('progress-percent');
    const gotoQuizBtn = document.getElementById('goto-quiz');

    // Level Filter Functionality
    const levelFilterBtns = document.querySelectorAll('.level-filter-btn');
    const storyCards = document.querySelectorAll('.story-card');

    levelFilterBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        const selectedLevel = btn.getAttribute('data-level');

        // Update active button
        levelFilterBtns.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');

        // Filter story cards
        storyCards.forEach(card => {
          const cardLevel = card.getAttribute('data-level');
          if (selectedLevel === 'all' || cardLevel === selectedLevel) {
            card.style.display = 'block';
            setTimeout(() => {
              card.style.opacity = '1';
              card.style.transform = 'translateY(0)';
            }, 10);
          } else {
            card.style.opacity = '0';
            card.style.transform = 'translateY(20px)';
            setTimeout(() => {
              card.style.display = 'none';
            }, 300);
          }
        });
      });
    });

    // Story Card Click - Load Story
    storyCards.forEach(card => {
      card.addEventListener('click', () => {
        const storyId = card.getAttribute('data-story-id');
        loadStory(storyId);
      });
    });

    // Load Story Function (Reactå®Ÿè£…æ™‚ã¯APIå‘¼ã³å‡ºã— + React Query)
    function loadStory(storyId) {
      appState.currentStoryId = storyId;
      appState.currentChapterId = 1;

      // Show loading
      storyListSection.style.display = 'none';
      loading.classList.add('show');

      // Simulate API call
      setTimeout(() => {
        loading.classList.remove('show');
        storyViewer.classList.add('active');
        resetProgress();
      }, 1000);
    }

    // Back to List
    backButton.addEventListener('click', () => {
      storyViewer.classList.remove('active');
      setTimeout(() => {
        storyListSection.style.display = 'block';
      }, 300);
    });

    // Toggle Ruby Display
    toggleRubyBtn.addEventListener('click', () => {
      appState.showRuby = !appState.showRuby;
      toggleRubyBtn.classList.toggle('active');

      if (appState.showRuby) {
        storyContent.classList.remove('hide-ruby');
      } else {
        storyContent.classList.add('hide-ruby');
      }
    });

    // Toggle Translation Display
    toggleTranslationBtn.addEventListener('click', () => {
      appState.showTranslation = !appState.showTranslation;
      toggleTranslationBtn.classList.toggle('active');

      if (appState.showTranslation) {
        translation.classList.add('show');
      } else {
        translation.classList.remove('show');
      }
    });

    // Audio Button Functionality (Reactå®Ÿè£…æ™‚ã¯Google Cloud TTS APIå‘¼ã³å‡ºã—)
    let isPlaying = false;
    audioButton.addEventListener('click', () => {
      if (!isPlaying) {
        isPlaying = true;
        audioButton.classList.add('playing');
        audioIcon.textContent = 'ğŸ”Š';
        audioText.textContent = 'éŸ³å£°å†ç”Ÿä¸­...';

        // Simulate audio playback
        setTimeout(() => {
          isPlaying = false;
          audioButton.classList.remove('playing');
          audioIcon.textContent = 'ğŸ”Š';
          audioText.textContent = 'éŸ³å£°ã‚’èã';
        }, 3000);
      }
    });

    // Choice Card Selection
    const choiceCards = document.querySelectorAll('.choice-card');
    choiceCards.forEach(card => {
      card.addEventListener('click', function() {
        const choiceId = this.getAttribute('data-choice-id');

        // Remove previous selections
        choiceCards.forEach(c => c.classList.remove('selected'));

        // Mark as selected with highlight
        this.classList.add('selected');
        appState.selectedChoiceId = choiceId;

        // Animate selection with brief scale effect
        this.style.transform = 'scale(1.03)';
        setTimeout(() => {
          this.style.transform = '';

          // Start fade out transition
          setTimeout(() => {
            loadNextChapter();
          }, 300);
        }, 200);
      });
    });

    // Load Next Chapter (Reactå®Ÿè£…æ™‚ã¯APIå‘¼ã³å‡ºã—)
    function loadNextChapter() {
      // Fade out current chapter
      storyViewer.style.opacity = '0';
      storyViewer.style.transform = 'translateY(-20px)';

      setTimeout(() => {
        loading.classList.add('show');

        setTimeout(() => {
          appState.currentChapterId++;
          appState.progress = Math.min(100, appState.progress + 20);
          updateProgress();

          // Reset selection and remove fade-out class
          choiceCards.forEach(c => {
            c.classList.remove('selected');
            c.classList.remove('fade-out');
          });

          loading.classList.remove('show');

          // Fade in new chapter
          storyViewer.style.opacity = '1';
          storyViewer.style.transform = 'translateY(0)';

          // Scroll to top smoothly
          window.scrollTo({ top: 0, behavior: 'smooth' });
        }, 800);
      }, 300);
    }

    // Update Progress
    function updateProgress() {
      progressFill.style.width = appState.progress + '%';
      progressPercent.textContent = appState.progress + '%';
    }

    // Reset Progress
    function resetProgress() {
      appState.progress = 20;
      updateProgress();
    }

    // Go to Quiz (Reactå®Ÿè£…æ™‚ã¯React Router navigate)
    gotoQuizBtn.addEventListener('click', () => {
      // Add active animation
      gotoQuizBtn.style.transform = 'scale(0.95)';

      setTimeout(() => {
        gotoQuizBtn.style.transform = '';

        // Show confirmation message with styled visual feedback
        const confirmMessage = confirm(
          'ã“ã®ãƒãƒ£ãƒ—ã‚¿ãƒ¼ã®ç†è§£åº¦ãƒã‚§ãƒƒã‚¯ã‚’å§‹ã‚ã¾ã™ã‹ï¼Ÿ\n\nâœ“ ç†è§£åº¦ãƒã‚§ãƒƒã‚¯ãƒšãƒ¼ã‚¸ã¸é·ç§»ã—ã¾ã™\nï¼ˆå®Ÿè£…æ™‚ã¯ P-002: ç†è§£åº¦ãƒã‚§ãƒƒã‚¯ï¼‹é€²æ—ãƒšãƒ¼ã‚¸ã¸ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ï¼‰'
        );

        if (confirmMessage) {
          // Simulate page transition with fade out
          storyViewer.style.opacity = '0';
          loading.classList.add('show');

          setTimeout(() => {
            alert('ç†è§£åº¦ãƒã‚§ãƒƒã‚¯ãƒšãƒ¼ã‚¸ã‚’èª­ã¿è¾¼ã‚“ã§ã„ã¾ã™...\n\nï¼ˆãƒ¢ãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®ãŸã‚ã€å®Ÿéš›ã®ãƒšãƒ¼ã‚¸é·ç§»ã¯è¡Œã‚ã‚Œã¾ã›ã‚“ï¼‰');
            loading.classList.remove('show');
            storyViewer.style.opacity = '1';
          }, 1000);
        }
      }, 100);
    });

    // Save Progress to LocalStorage (Reactå®Ÿè£…æ™‚ã‚‚åŒæ§˜)
    function saveProgress() {
      const progressData = {
        storyId: appState.currentStoryId,
        currentChapterId: appState.currentChapterId,
        completedChapters: appState.completedChapters,
        completionRate: appState.progress,
        lastAccessed: new Date().toISOString()
      };

      localStorage.setItem(
        `lingo_keeper_progress_${appState.currentStoryId}`,
        JSON.stringify(progressData)
      );
    }

    // Auto-save progress when choice is made
    choiceCards.forEach(card => {
      card.addEventListener('click', () => {
        setTimeout(saveProgress, 100);
      });
    });
  </script>
</body>
</html>
